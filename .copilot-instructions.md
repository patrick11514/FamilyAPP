# Copilot Instructions for FamilyAPP

This repository contains a SvelteKit family application with the following development setup:

## Package Management

- **Always use `pnpm`** instead of regular `npm`
- Install dependencies: `pnpm install`
- Run scripts: `pnpm run <script-name>`

## Environment Setup

- Copy `.env.example` to `.env` and fill in the required values
- For VAPI keys (push notifications), use this one-line command to generate them:

```bash
echo -e "const k=require('web-push').generateVAPIDKeys();console.log(\`PUBLIC_VAPI_KEY=\${k.publicKey}\\nPRIVATE_VAPI_KEY=\${k.privateKey}\`)" | node
```

## Key Environment Variables

- `ENERGYFACE_ID` - ID for EnergyFace controller systems
- `PUBLIC_VAPI_KEY` / `PRIVATE_VAPI_KEY` - Web push notification keys
- Database configuration variables (see .env.example)

## Development Commands

- `pnpm run dev` - Start development server
- `pnpm run build` - Build for production
- `pnpm run check` - TypeScript and Svelte checking
- `pnpm run lint` - Lint code
- `pnpm run format` - Format code with Prettier

## API Structure

- API endpoints are located in `/src/lib/server/routes/`
- Uses @patrick115/sveltekitapi for API structure
- Export new endpoints in the corresponding index.ts files

## EnergyFace Integration

- EnergyFace controller integration is in `/src/lib/server/energyface/`
- Current endpoints: `/api/energyface/get` and `/api/energyface/current`
- Uses device IDs from `EnergyFaceLabels` enum in utils.ts
